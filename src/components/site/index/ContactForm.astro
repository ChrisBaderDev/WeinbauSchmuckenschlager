---

---

<section
  class="flex flex-col items-center w-full justify-center mx-auto px-5 md:px-10 py-20 text-center"
>
  <h2 class="mb-4">Melde dich bei uns!</h2>
  <p class="text-gray-600 mb-8">
    Für eine Tischreservierung oder eine Frage zum Heurigen oder zu unseren
    Produkten fülle einfach das Formular aus. Wir melden uns schnellstmöglich.
  </p>

  <form id="contact-form" class="w-full flex flex-col gap-6">
    <label class="flex flex-col text-left text-sm">
      Vorname *
      <input
        type="text"
        name="vorname"
        required
        placeholder="Vorname"
        class="border-b border-gray-300 py-2 outline-none focus:border-black transition-colors bg-transparent"
      />
    </label>

    <label class="flex flex-col text-left text-sm">
      Nachname *
      <input
        type="text"
        name="nachname"
        required
        placeholder="Nachname"
        class="border-b border-gray-300 py-2 outline-none focus:border-black transition-colors bg-transparent"
      />
    </label>

    <label class="flex flex-col text-left text-sm">
      Email *
      <input
        type="email"
        name="email"
        placeholder="Email"
        required
        class="border-b border-gray-300 py-2 outline-none focus:border-black transition-colors bg-transparent"
      />
    </label>

    <label class="flex flex-col text-left text-sm">
      Telefon
      <input
        type="tel"
        name="telefon"
        placeholder="+43...."
        class="border-b border-gray-300 py-2 outline-none focus:border-black transition-colors bg-transparent"
      />
    </label>

    <label class="flex flex-col text-left text-sm">
      Nachricht *
      <textarea
        name="message"
        placeholder="Sollen wir sonst noch was wissen?"
        required
        rows="4"
        class="border border-gray-300 p-3 mt-1 outline-none focus:border-black transition-colors bg-transparent resize-none"
      ></textarea>
    </label>

    <button
      type="submit"
      class="bg-black text-white py-3 mt-4 hover:bg-neutral-800 transition-colors hover:cursor-pointer"
    >
      Abschicken
    </button>
    <!-- Success message (hidden by default) -->
  </form>
  <div id="success-message" class="hidden text-center py-12">
    <h3 class="mb-4">Vielen Dank!</h3>
    <p class="text-gray-600">
      Wir haben deine Nachricht erhalten und melden uns bald.
    </p>
  </div>
  <div id="failure-message" class="hidden text-center py-12">
    <h3 class="mb-4">Es gab ein Problem mit der Absendung!</h3>
    <p class="text-gray-600">
      Bitte versuchen Sie uns telefonisch zu erreichen.
    </p>
  </div>
</section>

<script>
  import Botpoison from "@botpoison/browser";

  const botpoison = new Botpoison({
    publicKey: "pk_6670cf52-9797-4e87-a3ef-742d372089ab",
  });

  const form = document.getElementById("contact-form") as HTMLFormElement;
  const successMessage = document.getElementById("success-message");
  const failureMessage = document.getElementById("failure-message");

  form?.addEventListener("submit", async (e) => {
    e.preventDefault();
    failureMessage?.classList.add("hidden");
    const formData = new FormData(form);
    const data = Object.fromEntries(formData);
    const submitBtn = form.querySelector(
      "button[type='submit']",
    ) as HTMLButtonElement;
    submitBtn.disabled = true;
    submitBtn.textContent = "Wird gesendet...";
    try {
      const { solution } = await botpoison.challenge();

      const response = await fetch("https://submit-form.com/NJlIg5AUL", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Accept: "application/json",
        },
        body: JSON.stringify({
          ...data,
          _email: {
            subject: "Neue Kontaktanfrage - Weinbau Schmuckenschlager",
            from: "Website - Weinbau Schmuckenschlager",
            template: {
              title: "Neue Kontaktanfrage",
            },
          },
          _botpoison: solution,
        }),
      });

      if (response.ok) {
        form.classList.add("hidden");
        successMessage?.classList.remove("hidden");
      } else {
        failureMessage?.classList.remove("hidden");
      }
    } catch (error) {
      failureMessage?.classList.remove("hidden");
    } finally {
      submitBtn.disabled = false;
      submitBtn.textContent = "Abschicken";
    }
  });
</script>
